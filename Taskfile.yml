version: '3'

tasks:
  default:
    cmds:
      - task: install
      - task: run
  dev:
    cmds:
      - task: install_dev
      - task: install
      - task: test
      - task: run_dev
  install_dev:
    cmds:
      - pip install -r requirements_dev.txt
  install:
    cmds:
      - pip install -r requirements.txt
  test:
    cmds:
      - python -m pytest
  run:
    cmds:
      - python -m fastapi run ./src/HiveBox/main.py
  run_dev:
    cmds:
      - python -m fastapi dev ./src/HiveBox/main.py
  precommit:
    cmds:
      - pre-commit run --all-files
  compose:
    cmds:
      - docker compose up -d --build --remove-orphans
